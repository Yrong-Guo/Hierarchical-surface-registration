while getopts 'n:' flag; do
  case "${flag}" in
    n) iter_num="${OPTARG}" ;;
    *)
      echo "Usage: $0 [-n iter_num]"
      exit 1
      ;;
  esac
done
iter_num_last=$((${iter_num} - 1))
wb_command -metric-math '(x0+x1+x2+x3+x4+x5+x6+x7+x8+x9+x10+x11+x12+x13+x14+x15+x16+x17+x18+x19+x20+x21+x22+x23+x24+x25+x26+x27+x28+x29+x30+x31+x32+x33+x34+x35+x36+x37+x38+x39+x40+x41+x42+x43+x44+x45+x46+x47+x48+x49+x50+x51+x52+x53+x54+x55+x56+x57+x58+x59+x60+x61)/62' /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/NODE2139_${iter_num}.curv.affine.ico6.shape.gii -var x0 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/580650.R.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x1 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/237334.L.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x2 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/580650.L.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x3 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/694362.L.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x4 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/185038.R.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x5 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/671855.L.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x6 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/707749.L.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x7 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/299760.L.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x8 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/176239.L.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x9 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/763557.L.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x10 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/361941.R.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x11 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/662551.L.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x12 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/662551.R.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x13 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/160729.R.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x14 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/351938.R.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x15 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/118225.R.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x16 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/904044.R.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x17 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/100610.R.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x18 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/541943.R.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x19 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/385046.L.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x20 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/185846.L.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x21 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/520228.L.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x22 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/185846.R.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x23 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/552544.L.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x24 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/305830.R.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x25 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/748258.L.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x26 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/748258.R.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x27 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/952863.L.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x28 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/355239.R.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x29 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/160931.L.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x30 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/361234.L.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x31 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/987983.R.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x32 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/111514.L.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x33 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/201818.L.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x34 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/580347.L.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x35 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/123420.L.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x36 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/825654.L.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x37 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/200210.L.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x38 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/513736.R.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x39 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/635245.L.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x40 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/165638.R.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x41 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/580044.R.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x42 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/144226.R.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x43 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/162329.R.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x44 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/198451.R.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x45 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/622236.R.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x46 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/348545.L.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x47 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/581349.L.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x48 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/102311.L.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x49 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/693461.L.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x50 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/148436.L.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x51 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/555348.L.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x52 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/220721.L.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x53 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/138332.R.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x54 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/749361.R.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x55 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/185038.L.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x56 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/541640.L.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x57 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/268850.L.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x58 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/571548.L.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x59 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/110613.L.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x60 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/134627.L.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii -var x61 /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/330324.L.MSM.NODE2139_${iter_num}.transformed_and_reprojected.func.gii;
wb_command -metric-math 'abs(x-y)' /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/difference.shape.gii -var x /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/NODE2139_${iter_num_last}.curv.affine.ico6.shape.gii -var y /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/NODE2139_${iter_num}.curv.affine.ico6.shape.gii;
diff=$(wb_command -metric-stats /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/difference.shape.gii -reduce MEAN -roi /HPC_work_dir/frontal_lobe/rotated_deformed_frontal_lobe_corrdice/NODE2139_frontal_mask.shape.gii);
echo $diff;

cp /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/NODE2139_${iter_num}.curv.affine.ico6.shape.gii /HPC_work_dir/corrdice_affine_mask/checkNODE2139_msmrefine/NODE2139.final.curv.affine.ico6.shape.gii
