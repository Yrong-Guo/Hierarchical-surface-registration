while getopts 'n:' flag; do
  case "${flag}" in
    n) iter_num="${OPTARG}" ;;
    *)
      echo "Usage: $0 [-n iter_num]"
      exit 1
      ;;
  esac
done
iter_num_last=$((${iter_num} - 1))
wb_command -metric-math '(x0+x1+x2+x3+x4+x5+x6+x7+x8+x9+x10+x11+x12+x13+x14+x15+x16+x17+x18+x19+x20+x21+x22+x23+x24+x25+x26+x27+x28+x29+x30+x31+x32+x33+x34+x35+x36+x37+x38+x39+x40+x41+x42+x43+x44+x45+x46+x47+x48+x49+x50+x51+x52+x53+x54+x55+x56+x57+x58+x59+x60+x61+x62+x63+x64+x65+x66+x67+x68+x69+x70+x71+x72+x73+x74+x75+x76+x77+x78+x79+x80+x81+x82+x83+x84+x85+x86+x87+x88+x89+x90+x91+x92+x93+x94+x95+x96+x97+x98)/99' /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/NODE2177_${iter_num}.curv.affine.ico6.shape.gii -var x0 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/195647.L.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x1 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/280941.L.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x2 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/201515.L.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x3 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/499566.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x4 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/756055.L.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x5 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/172130.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x6 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/208024.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x7 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/196952.L.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x8 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/679568.L.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x9 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/138332.L.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x10 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/208226.L.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x11 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/103212.L.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x12 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/173233.L.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x13 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/173738.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x14 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/110613.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x15 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/952863.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x16 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/299154.L.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x17 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/816653.L.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x18 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/138130.L.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x19 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/737960.L.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x20 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/395756.L.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x21 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/211720.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x22 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/134728.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x23 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/117930.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x24 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/211922.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x25 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/201717.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x26 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/765056.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x27 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/917255.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x28 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/495255.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x29 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/792867.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x30 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/263436.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x31 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/358144.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x32 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/683256.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x33 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/122418.L.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x34 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/376247.L.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x35 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/112112.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x36 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/845458.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x37 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/601127.L.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x38 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/559457.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x39 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/118225.L.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x40 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/197348.L.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x41 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/844961.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x42 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/100408.L.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x43 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/553344.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x44 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/206727.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x45 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/686969.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x46 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/843151.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x47 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/107422.L.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x48 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/984472.L.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x49 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/381038.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x50 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/105115.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x51 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/827052.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x52 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/127327.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x53 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/104416.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x54 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/800941.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x55 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/194746.L.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x56 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/521331.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x57 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/989987.L.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x58 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/587664.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x59 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/734247.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x60 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/118831.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x61 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/140319.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x62 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/146129.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x63 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/280941.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x64 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/951457.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x65 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/153126.L.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x66 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/953764.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x67 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/209531.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x68 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/211821.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x69 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/378756.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x70 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/298051.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x71 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/773257.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x72 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/122620.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x73 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/204420.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x74 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/150524.L.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x75 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/463040.L.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x76 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/130013.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x77 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/227432.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x78 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/983773.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x79 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/111716.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x80 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/170934.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x81 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/415837.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x82 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/449753.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x83 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/177342.L.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x84 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/138534.L.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x85 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/177342.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x86 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/570243.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x87 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/144933.L.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x88 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/194443.L.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x89 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/803240.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x90 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/588565.L.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x91 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/541640.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x92 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/379657.L.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x93 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/579665.L.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x94 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/156031.L.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x95 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/191942.L.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x96 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/872158.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x97 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/144428.L.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii -var x98 /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/106016.R.MSM.NODE2177_${iter_num}.transformed_and_reprojected.func.gii;
wb_command -metric-math 'abs(x-y)' /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/difference.shape.gii -var x /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/NODE2177_${iter_num_last}.curv.affine.ico6.shape.gii -var y /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/NODE2177_${iter_num}.curv.affine.ico6.shape.gii;
diff=$(wb_command -metric-stats /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/difference.shape.gii -reduce MEAN -roi /HPC_work_dir/frontal_lobe/rotated_deformed_frontal_lobe_corrdice/NODE2177_frontal_mask.shape.gii);
echo $diff;

cp /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/NODE2177_${iter_num}.curv.affine.ico6.shape.gii /HPC_work_dir/corrdice_affine_mask/checkNODE2177_msmrefine/NODE2177.final.curv.affine.ico6.shape.gii
