while getopts 'n:' flag; do
  case "${flag}" in
    n) iter_num="${OPTARG}" ;;
    *)
      echo "Usage: $0 [-n iter_num]"
      exit 1
      ;;
  esac
done
iter_num_last=$((${iter_num} - 1))
wb_command -metric-math '(x0+x1+x2+x3+x4+x5+x6+x7+x8+x9+x10+x11+x12+x13+x14+x15+x16+x17+x18+x19+x20+x21+x22+x23+x24+x25+x26+x27+x28+x29+x30+x31+x32+x33+x34+x35+x36+x37+x38+x39+x40+x41+x42+x43+x44+x45+x46+x47+x48+x49+x50+x51+x52+x53+x54+x55+x56+x57+x58+x59+x60+x61+x62+x63+x64+x65+x66+x67+x68+x69+x70+x71+x72+x73+x74+x75+x76+x77+x78+x79+x80+x81+x82+x83+x84+x85+x86+x87+x88+x89+x90+x91+x92+x93+x94+x95)/96' /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/NODE2176_${iter_num}.curv.affine.ico6.shape.gii -var x0 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/138231.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x1 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/138231.R.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x2 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/151021.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x3 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/151021.R.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x4 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/833249.R.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x5 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/137229.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x6 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/214625.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x7 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/180533.R.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x8 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/102715.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x9 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/123723.R.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x10 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/393247.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x11 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/148840.R.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x12 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/978578.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x13 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/121416.R.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x14 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/169545.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x15 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/191235.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x16 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/113215.R.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x17 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/211215.R.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x18 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/307127.R.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x19 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/112920.R.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x20 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/978578.R.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x21 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/161630.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x22 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/307127.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x23 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/996782.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x24 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/996782.R.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x25 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/206525.R.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x26 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/198855.R.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x27 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/991267.R.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x28 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/193845.R.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x29 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/611938.R.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x30 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/141119.R.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x31 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/734045.R.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x32 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/159744.R.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x33 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/192843.R.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x34 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/308331.R.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x35 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/751550.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x36 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/128632.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x37 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/304727.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x38 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/793465.R.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x39 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/942658.R.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x40 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/376247.R.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x41 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/122418.R.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x42 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/453542.R.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x43 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/995174.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x44 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/185947.R.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x45 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/927359.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x46 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/263436.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x47 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/138837.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x48 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/680452.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x49 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/137027.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x50 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/158338.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x51 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/422632.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x52 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/626648.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x53 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/609143.R.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x54 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/103212.R.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x55 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/579867.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x56 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/884064.R.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x57 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/136833.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x58 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/114116.R.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x59 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/486759.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x60 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/735148.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x61 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/120212.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x62 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/211417.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x63 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/211821.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x64 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/178647.R.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x65 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/832651.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x66 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/129129.R.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x67 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/212116.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x68 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/187143.R.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x69 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/140925.R.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x70 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/171431.R.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x71 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/107321.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x72 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/202820.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x73 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/102614.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x74 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/111312.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x75 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/101309.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x76 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/103010.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x77 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/449753.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x78 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/122822.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x79 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/512835.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x80 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/103515.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x81 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/153631.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x82 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/135528.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x83 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/833249.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x84 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/169141.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x85 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/599469.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x86 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/127832.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x87 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/733548.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x88 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/378857.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x89 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/164939.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x90 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/187345.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x91 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/151829.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x92 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/201111.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x93 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/634748.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x94 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/250427.L.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii -var x95 /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/153631.R.MSM.NODE2176_${iter_num}.transformed_and_reprojected.func.gii;
wb_command -metric-math 'abs(x-y)' /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/difference.shape.gii -var x /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/NODE2176_${iter_num_last}.curv.affine.ico6.shape.gii -var y /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/NODE2176_${iter_num}.curv.affine.ico6.shape.gii;
diff=$(wb_command -metric-stats /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/difference.shape.gii -reduce MEAN -roi /HPC_work_dir/frontal_lobe/rotated_deformed_frontal_lobe_corrdice/NODE2176_frontal_mask.shape.gii);
echo $diff;

cp /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/NODE2176_${iter_num}.curv.affine.ico6.shape.gii /HPC_work_dir/corrdice_affine_mask/checkNODE2176_msmrefine/NODE2176.final.curv.affine.ico6.shape.gii
